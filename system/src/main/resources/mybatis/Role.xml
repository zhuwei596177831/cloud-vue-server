<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.system.mapper.RoleMapper">

    <resultMap id="baseResultMap" type="com.example.system.entity.Role">
        <result property="checkedMenuIds" column="checkedMenuIds" typeHandler="com.baomidou.mybatisplus.extension.handlers.JacksonTypeHandler"/>
        <result property="inputUserName" column="inputUserName"/>
        <result property="updateUserName" column="updateUserName"/>
    </resultMap>

    <select id="roleList" resultMap="baseResultMap">
        select t.id,t.code,t.name,t.inputTime,t.inputUserId,t.updateTime,t.updateUserId,t.checkedMenuIds,
        i.name as inputUserName,u.name as updateUserName
        from `system`.t_role t
        left join `system`.t_user i on t.inputUserId = i.id
        left join `system`.t_user u on t.inputUserId = u.id
        <where>
            <if test="name != null and name != ''">
                t.name like concat('%',trim(#{name}),'%')
            </if>
        </where>
        order by t.id desc
    </select>

    <select id="findRolesByUserId" resultType="com.example.system.entity.Role">
        select r.id, r.code, r.name
        from `system`.t_role r,
             `system`.t_user u,
             `system`.t_user_role tur
        where r.id = tur.roleId
          and tur.userId = u.id
          and u.id = #{userId}
    </select>

</mapper>